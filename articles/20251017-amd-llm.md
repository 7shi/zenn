---
title: "Ryzen AI Max+ 395 で LLM 推論速度を比較"
emoji: "🦙"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AMD", "Ryzen", "LLM", "AI"]
published: true
---

# はじめに

AMD Ryzen AI Max+ 395 を搭載した EVO-X2 で、gpt-oss:20b を CPU/GPU/NPU で動作させて処理速度を比較します。

:::message
本記事は Claude Code の生成結果をベースに編集しました。
:::

# 測定環境

- **プロセッサ**: AMD Ryzen AI Max+ 395（16コア）
- **OS**: Windows 11 Pro 24H2
- **モデル**: gpt-oss:20b
- **ソフトウェア**:
  - CPU/GPU: [Ollama](https://ollama.com/) 0.12.6
  - NPU: [FastFlowLM (FLM)](https://github.com/FastFlowLM/FastFlowLM) 0.9.13
- **プロンプト**: AIの将来を予測してください。
- **測定方法**:
  - Ollama: `/set verbose`
  - FLM: `/verbose`

# 測定結果

単位: tokens/s（1秒あたりのトークン数）

| デバイス | プロンプト評価速度 | 生成速度 |
|---------|-----------------:|---------:|
| CPU     | 92.58            | 17.04    |
| GPU     | 401.46           | 44.58    |
| NPU     | 18.20            | 10.94    |

GPU が最も高速で、CPU は NPU よりも高い性能を示し、NPU は最も低速でした。

:::message
FLM では、プロンプト処理は Prefill、トークン生成は Decoding と表現されます。
:::

## 120B との比較

GPU で gpt-oss:120b を動作させると、プロンプト評価速度 209.07 / 生成速度 33.87 でした。パラメーター数は 6 倍ですが、MoE を適切に構成することで速度低下が抑えられています。

Ryzen AI Max+ 395 の VRAM 容量を活かしつつ実用的な速度で動くモデルとして理想に近いかもしれません。

## その他

その他のモデルの計測結果については、以下を参照してください。（GPU のみ）

- https://gist.github.com/7shi/013baeb748f63fdb3057b9a682832fdb

# NPU について

NPU には以下のような特徴があります。

- **CPU負荷の軽減**: NPU で推論を実行することで、CPU を他のタスクに使用できる
- **消費電力の効率**: NPU は AI 処理に特化しており、同じ処理を CPU で行うより消費電力が少ないとされている
- **モバイル用途での優位性**: バッテリー駆動のノート PC では、消費電力の低さが稼働時間に直結

Ryzen AI Max+ 395 は 16 コアという強力な CPU を搭載しているため、NPU の性能優位性が見られませんでした。

また、デスクトップ環境で LLM を動かす場合、以下の理由から NPU の優位性は限定的です。

- 十分な電力供給があるため、消費電力の差が大きな問題にならない
- 強力な GPU が利用可能
- CPU 負荷が掛からないのは GPU でも同様

ただし、複数の AI タスクを並行実行する場合や、AI タスクを実行しながら他の重い処理を行う場合には、NPU の存在意義が出てくる可能性があります。

:::message
Recall のような「裏方であまり電力消費せずに常時稼働するようなAI処理向け」ではないかとのご指摘をいただきました。👉[リンク](https://x.com/m_matsubara/status/1979539190766514495)
:::

これらの課題は業界でも認識されているようで、AMD が将来の Zen 6 系 APU 製品で NPU の搭載を取りやめる可能性があるという噂も出ています。

https://gazlog.com/entry/amd-zen6-no-more-npu/

# まとめ

Ryzen AI Max+ 395 での LLM 推論速度測定は GPU > CPU > NPU という結果になりました。デスクトップ環境では NPU のメリットが少ないため、GPU での実行が推奨されます。

# 関連記事

NPU がなかなか活用されない状況について調査した記事です。NPU では大型モデルを動かすことは想定されておらず、処理速度もそれほど高速ではないことが示唆されました。

https://note.com/7shi/n/nb372abf33ba9

VRAM に収まる範囲での比較では、Radeon AI Max+ 395 の GPU (Radeon 8060S) は Radeon RX 7600 XTより少し速く、CPU は Radeon 780M (iGPU) より少し速いという結果でした。

https://qiita.com/7shi/items/dc037c2d5b0add0da33a
